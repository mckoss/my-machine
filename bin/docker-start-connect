#!/bin/bash
# start-sshd --- Start docker image and connect to ssh server on it.

if [[ "$1" != "" ]]; then
    IMAGE="$1"; shift
else
    IMAGE="mckoss/sshd"
fi

docker run -p 22 -d $IMAGE
URI=$(docker port $(docker ps -l -q) 22)
IF=${URI/:*/}
PORT=${URI/*:/}

echo "Connecting to ${IF}:${PORT} as user service (password 'service'):"
sleep 1
ssh service@${IF} -p $PORT
